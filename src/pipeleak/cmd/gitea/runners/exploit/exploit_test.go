package exploit

import (
	"testing"
)

func TestNewExploitCmd(t *testing.T) {
	url := "https://example.com"
	token := "test-token"
	
	cmd := NewExploitCmd(&url, &token)

	if cmd == nil {
		t.Fatal("Expected non-nil command")
	}

	if cmd.Use != "exploit" {
		t.Errorf("Expected Use to be 'exploit', got %q", cmd.Use)
	}

	if cmd.Short == "" {
		t.Error("Expected non-empty Short description")
	}

	if cmd.Long == "" {
		t.Error("Expected non-empty Long description")
	}

	if cmd.Example == "" {
		t.Error("Expected non-empty Example")
	}

	flags := cmd.Flags()
	if flags.Lookup("labels") == nil {
		t.Error("Expected 'labels' flag to be defined")
	}
	if flags.Lookup("age-public-key") == nil {
		t.Error("Expected 'age-public-key' flag to be defined")
	}
	if flags.Lookup("repo-name") == nil {
		t.Error("Expected 'repo-name' flag to be defined")
	}

	persistentFlags := cmd.PersistentFlags()
	if persistentFlags.Lookup("dry") == nil {
		t.Error("Expected 'dry' persistent flag to be defined")
	}
	if persistentFlags.Lookup("shell") == nil {
		t.Error("Expected 'shell' persistent flag to be defined")
	}
}
